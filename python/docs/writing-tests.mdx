---
id: writing-tests
title: "撰寫測試"
---
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import HTMLCard from '@site/src/components/HTMLCard';
import ProgressiveImage from '@theme/ProgressiveImage';

## 簡介

Playwright 測試很簡單，它們
- **執行動作**，以及
- **斷言狀態**符合預期。

執行動作前無需等待任何事項：Playwright 會在執行每個動作前自動等待各種[可動作性](./actionability.mdx)檢查通過。

執行檢查時也無需處理競爭條件 - Playwright 斷言的設計方式是描述最終需要滿足的預期。

就是這樣！這些設計選擇讓 Playwright 使用者能夠完全忘記測試中的不穩定逾時和競爭檢查。

**您將學習**
- [如何撰寫第一個測試](/writing-tests.mdx#first-test)
- [如何執行動作](/writing-tests.mdx#actions)
- [如何使用斷言](/writing-tests.mdx#assertions)
- [測試如何在隔離環境中執行](/writing-tests.mdx#test-isolation)
- [如何使用測試掛勾](/writing-tests.mdx#using-fixtures)

## 第一個測試

查看以下範例了解如何撰寫測試。注意檔案名稱遵循 `test_` 前綴慣例，每個測試名稱也是如此。

```python title="test_example.py"
import re
from playwright.sync_api import Page, expect

def test_has_title(page: Page):
    page.goto("https://playwright.dev/")

    # Expect a title "to contain" a substring.
    expect(page).to_have_title(re.compile("Playwright"))

def test_get_started_link(page: Page):
    page.goto("https://playwright.dev/")

    # Click the get started link.
    page.get_by_role("link", name="Get started").click()

    # Expects page to have a heading with the name of Installation.
    expect(page.get_by_role("heading", name="Installation")).to_be_visible()
```

## Actions

### Navigation

大部分的測試會先導航到 URL。之後，測試能夠與頁面元素互動。

```python
page.goto("https://playwright.dev/")
```

Playwright 會等待頁面達到載入狀態後再繼續。了解更多關於 [page.goto()](/api/class-page.mdx#page-goto) 選項的資訊。

### Interactions

執行動作始於定位元素。Playwright 使用[定位器 API](./locators.mdx) 來達成此目的。定位器代表在任何時刻尋找頁面上元素的方法，了解更多關於可用的[不同類型](./locators.mdx)定位器。Playwright 會在執行動作前等待元素變成[可動作](./actionability.mdx)狀態，因此不需要等待它變成可用狀態。

```python
# Create a locator.
get_started = page.get_by_role("link", name="Get started")

# Click it.
get_started.click()
```

In most cases, it'll be written in one line:

```python
page.get_by_role("link", name="Get started").click()
```

### Basic actions

這是最受歡迎的 Playwright 動作清單。注意還有更多動作，請務必查看[定位器 API](./api/class-locator.mdx) 部分以了解更多。

| Action | Description |
| :- | :- |
| [locator.check()](/api/class-locator.mdx#locator-check) | Check the input checkbox |
| [locator.click()](/api/class-locator.mdx#locator-click) | Click the element |
| [locator.uncheck()](/api/class-locator.mdx#locator-uncheck) | Uncheck the input checkbox |
| [locator.hover()](/api/class-locator.mdx#locator-hover) | Hover mouse over the element |
| [locator.fill()](/api/class-locator.mdx#locator-fill) | Fill the form field, input text |
| [locator.focus()](/api/class-locator.mdx#locator-focus) | Focus the element |
| [locator.press()](/api/class-locator.mdx#locator-press) | Press single key |
| [locator.set_input_files()](/api/class-locator.mdx#locator-set-input-files) | Pick files to upload |
| [locator.select_option()](/api/class-locator.mdx#locator-select-option) | Select option in the drop down |

## Assertions

Playwright 包含會等待直到預期條件滿足的[斷言](./test-assertions.mdx)。使用這些斷言可以讓測試變得不脆弱且具有彈性。例如，此程式碼會等待直到頁面獲得包含 "Playwright" 的標題：

```python
import re
from playwright.sync_api import expect

expect(page).to_have_title(re.compile("Playwright"))
```

以下是最受歡迎的非同步斷言清單。請注意還有[更多](./test-assertions.mdx)斷言可以熟悉：

| Assertion | Description |
| :- | :- |
| [expect(locator).to_be_checked()](/api/class-locatorassertions.mdx#locator-assertions-to-be-checked) | Checkbox is checked |
| [expect(locator).to_be_enabled()](/api/class-locatorassertions.mdx#locator-assertions-to-be-enabled) | Control is enabled |
| [expect(locator).to_be_visible()](/api/class-locatorassertions.mdx#locator-assertions-to-be-visible) | Element is visible |
| [expect(locator).to_contain_text()](/api/class-locatorassertions.mdx#locator-assertions-to-contain-text) | Element contains text |
| [expect(locator).to_have_attribute()](/api/class-locatorassertions.mdx#locator-assertions-to-have-attribute) | Element has attribute |
| [expect(locator).to_have_count()](/api/class-locatorassertions.mdx#locator-assertions-to-have-count) | List of elements has given length |
| [expect(locator).to_have_text()](/api/class-locatorassertions.mdx#locator-assertions-to-have-text) | Element matches text |
| [expect(locator).to_have_value()](/api/class-locatorassertions.mdx#locator-assertions-to-have-value) | Input element has value |
| [expect(page).to_have_title()](/api/class-pageassertions.mdx#page-assertions-to-have-title) | Page has title |
| [expect(page).to_have_url()](/api/class-pageassertions.mdx#page-assertions-to-have-url) | Page has URL |

### Test isolation

Playwright Pytest 外掛基於測試佈置的概念，例如傳遞給測試的[內建頁面佈置](./test-runners.mdx)。由於[瀏覽器情境](./browser-contexts)，頁面在測試之間是[隔離的](./browser-contexts)，這相當於全新的瀏覽器設定檔，每個測試都獲得新的環境，即使多個測試在單一瀏覽器中執行也是如此。

```python title="test_example.py"
from playwright.sync_api import Page

def test_example_test(page: Page):
  pass
  # "page" belongs to an isolated BrowserContext, created for this specific test.

def test_another_test(page: Page):
  pass
  # "page" in this second test is completely isolated from the first test.
```

### Using fixtures

您可以使用各種[佈置](https://docs.pytest.org/en/6.2.x/fixture.html#autouse-fixtures-fixtures-you-don-t-have-to-request)在測試前後執行程式碼，並在測試之間共享物件。例如，具有自動使用功能的 `function` 範圍佈置表現得像 beforeEach/afterEach。而具有自動使用功能的 `module` 範圍佈置表現得像 beforeAll/afterAll，會在所有測試之前和之後執行。

```python title="test_example.py"
import pytest
from playwright.sync_api import Page, expect

@pytest.fixture(scope="function", autouse=True)
def before_each_after_each(page: Page):
    
    print("before the test runs")

    # Go to the starting url before each test.
    page.goto("https://playwright.dev/")
    yield
    
    print("after the test runs")

def test_main_navigation(page: Page):
    # Assertions use the expect API.
    expect(page).to_have_url("https://playwright.dev/")
```

## What's next
- [Run single test, multiple tests, headed mode](./running-tests.mdx)
- [Generate tests with Codegen](./codegen-intro.mdx)
- [See a trace of your tests](./trace-viewer-intro.mdx)
- [Run tests on CI with GitHub Actions](./ci-intro.mdx)


[Accessibility]: /api/class-accessibility.mdx "Accessibility"
[APIRequest]: /api/class-apirequest.mdx "APIRequest"
[APIRequestContext]: /api/class-apirequestcontext.mdx "APIRequestContext"
[APIResponse]: /api/class-apiresponse.mdx "APIResponse"
[APIResponseAssertions]: /api/class-apiresponseassertions.mdx "APIResponseAssertions"
[Browser]: /api/class-browser.mdx "Browser"
[BrowserContext]: /api/class-browsercontext.mdx "BrowserContext"
[BrowserType]: /api/class-browsertype.mdx "BrowserType"
[CDPSession]: /api/class-cdpsession.mdx "CDPSession"
[Clock]: /api/class-clock.mdx "Clock"
[ConsoleMessage]: /api/class-consolemessage.mdx "ConsoleMessage"
[Dialog]: /api/class-dialog.mdx "Dialog"
[Download]: /api/class-download.mdx "Download"
[ElementHandle]: /api/class-elementhandle.mdx "ElementHandle"
[Error]: /api/class-error.mdx "Error"
[FileChooser]: /api/class-filechooser.mdx "FileChooser"
[Frame]: /api/class-frame.mdx "Frame"
[FrameLocator]: /api/class-framelocator.mdx "FrameLocator"
[JSHandle]: /api/class-jshandle.mdx "JSHandle"
[Keyboard]: /api/class-keyboard.mdx "Keyboard"
[Locator]: /api/class-locator.mdx "Locator"
[LocatorAssertions]: /api/class-locatorassertions.mdx "LocatorAssertions"
[Mouse]: /api/class-mouse.mdx "Mouse"
[Page]: /api/class-page.mdx "Page"
[PageAssertions]: /api/class-pageassertions.mdx "PageAssertions"
[Playwright]: /api/class-playwright.mdx "Playwright"
[Request]: /api/class-request.mdx "Request"
[Response]: /api/class-response.mdx "Response"
[Route]: /api/class-route.mdx "Route"
[Selectors]: /api/class-selectors.mdx "Selectors"
[TimeoutError]: /api/class-timeouterror.mdx "TimeoutError"
[Touchscreen]: /api/class-touchscreen.mdx "Touchscreen"
[Tracing]: /api/class-tracing.mdx "Tracing"
[Video]: /api/class-video.mdx "Video"
[WebError]: /api/class-weberror.mdx "WebError"
[WebSocket]: /api/class-websocket.mdx "WebSocket"
[WebSocketRoute]: /api/class-websocketroute.mdx "WebSocketRoute"
[Worker]: /api/class-worker.mdx "Worker"
[Element]: https://developer.mozilla.org/en-US/docs/Web/API/element "Element"
[EvaluationArgument]: /evaluating.mdx#evaluation-argument "EvaluationArgument"
[Promise]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise "Promise"
[iterator]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols "Iterator"
[origin]: https://developer.mozilla.org/en-US/docs/Glossary/Origin "Origin"
[selector]: https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors "selector"
[Serializable]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify#Description "Serializable"
[UIEvent.detail]: https://developer.mozilla.org/en-US/docs/Web/API/UIEvent/detail "UIEvent.detail"
[UnixTime]: https://en.wikipedia.org/wiki/Unix_time "Unix Time"
[xpath]: https://developer.mozilla.org/en-US/docs/Web/XPath "xpath"

[Any]: https://docs.python.org/3/library/typing.html#typing.Any "Any"
[bool]: https://docs.python.org/3/library/stdtypes.html "bool"
[bytes]: https://docs.python.org/3/library/stdtypes.html#bytes "bytes"
[Callable]: https://docs.python.org/3/library/typing.html#typing.Callable "Callable"
[EventContextManager]: https://docs.python.org/3/reference/datamodel.html#context-managers "Event context manager"
[EventEmitter]: https://pyee.readthedocs.io/en/latest/#pyee.BaseEventEmitter "EventEmitter"
[Exception]: https://docs.python.org/3/library/exceptions.html#Exception "Exception"
[Dict]: https://docs.python.org/3/library/typing.html#typing.Dict "Dict"
[float]: https://docs.python.org/3/library/stdtypes.html#numeric-types-int-float-complex "float"
[int]: https://docs.python.org/3/library/stdtypes.html#numeric-types-int-float-complex "int"
[List]: https://docs.python.org/3/library/typing.html#typing.List "List"
[NoneType]: https://docs.python.org/3/library/constants.html#None "None"
[Pattern]: https://docs.python.org/3/library/re.html "Pattern"
[URL]: https://en.wikipedia.org/wiki/URL "URL"
[pathlib.Path]: https://realpython.com/python-pathlib/ "pathlib.Path"
[str]: https://docs.python.org/3/library/stdtypes.html#text-sequence-type-str "str"
[Union]: https://docs.python.org/3/library/typing.html#typing.Union "Union"
[datetime]: https://docs.python.org/3/library/datetime.html#datetime.datetime "datetime"

[all available image tags]: https://mcr.microsoft.com/en-us/product/playwright/python/about "all available image tags"
[Microsoft Artifact Registry]: https://mcr.microsoft.com/en-us/product/playwright/python/about "Microsoft Artifact Registry"
[Dockerfile.noble]: https://github.com/microsoft/playwright-python/blob/main/utils/docker/Dockerfile.noble "Dockerfile.noble"
